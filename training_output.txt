Files will be saved to: /Users/cindyhu/PycharmProjects/SPIRAL-baseline/out
Loading files...
train_file_sample:  [{'train_cta1': '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/013/CTA1.nii.gz', 'train_cta2': '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/013/CTA2regA.nii.gz', 'train_cta3': '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/013/CTA3regA.nii.gz', 'train_spiral': ['/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/027/SpiralregA.nii', '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/379/SpiralregA.nii', '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/423/SpiralregA.nii'], 'label': '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/013/013_clot.nii'}, {'train_cta1': '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/027/CTA1.nii.gz', 'train_cta2': '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/027/CTA2regA.nii.gz', 'train_cta3': '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/027/CTA3regA.nii.gz', 'train_spiral': ['/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/027/SpiralregA.nii', '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/379/SpiralregA.nii', '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/423/SpiralregA.nii'], 'label': '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/027/027_clot.nii'}, {'train_cta1': '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/379/CTA1.nii.gz', 'train_cta2': '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/379/CTA2regA.nii.gz', 'train_cta3': '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/379/CTA3regA.nii.gz', 'train_spiral': ['/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/027/SpiralregA.nii', '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/379/SpiralregA.nii', '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/423/SpiralregA.nii'], 'label': '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/379/379_clot.nii'}, {'train_cta1': '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/423/CTA1.nii.gz', 'train_cta2': '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/423/CTA2regA.nii.gz', 'train_cta3': '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/423/CTA3regA.nii.gz', 'train_spiral': ['/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/027/SpiralregA.nii', '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/379/SpiralregA.nii', '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/423/SpiralregA.nii'], 'label': '/Users/cindyhu/PycharmProjects/SPIRAL-baseline/Capstone_Project_Data/423/423_clot.nii'}]
Total 3 subjects for training.
Total 1 subjects for validation.
Starting training over 10 epochs...
----------
epoch 1/10
1/3, train_loss: 1.7982 step time: 0.4304
2/3, train_loss: 0.9737 step time: 0.4009
3/3, train_loss: 1.0308 step time: 0.3797
epoch 1 average loss: 1.2676
time consuming of epoch 1 is: 1.2111
----------
epoch 2/10
1/3, train_loss: 1.0195 step time: 0.3668
2/3, train_loss: 0.9833 step time: 0.3595
3/3, train_loss: 1.0105 step time: 0.3555
epoch 2 average loss: 1.0044
time consuming of epoch 2 is: 1.0819
----------
epoch 3/10
1/3, train_loss: 0.9869 step time: 0.3973
2/3, train_loss: 1.0156 step time: 0.3501
3/3, train_loss: 1.0084 step time: 0.3589
epoch 3 average loss: 1.0036
time consuming of epoch 3 is: 1.1064
----------
epoch 4/10
1/3, train_loss: 0.9862 step time: 0.3711
2/3, train_loss: 1.0081 step time: 0.3577
3/3, train_loss: 1.0109 step time: 0.3720
epoch 4 average loss: 1.0018
time consuming of epoch 4 is: 1.1008
----------
epoch 5/10
1/3, train_loss: 1.0066 step time: 0.3796
2/3, train_loss: 1.0115 step time: 0.3603
3/3, train_loss: 0.9906 step time: 0.3636
epoch 5 average loss: 1.0029
time consuming of epoch 5 is: 1.1036
----------
epoch 6/10
1/3, train_loss: 1.0061 step time: 0.3821
2/3, train_loss: 0.9899 step time: 0.3689
3/3, train_loss: 1.0092 step time: 0.3588
epoch 6 average loss: 1.0018
time consuming of epoch 6 is: 1.1100
----------
epoch 7/10
1/3, train_loss: 0.9895 step time: 0.3619
2/3, train_loss: 1.0057 step time: 0.3600
3/3, train_loss: 1.0096 step time: 0.3663
epoch 7 average loss: 1.0016
time consuming of epoch 7 is: 1.0884
----------
epoch 8/10
1/3, train_loss: 0.9901 step time: 0.3589
2/3, train_loss: 1.0061 step time: 0.3613
3/3, train_loss: 1.0104 step time: 0.3610
epoch 8 average loss: 1.0022
time consuming of epoch 8 is: 1.0813
----------
epoch 9/10
1/3, train_loss: 1.0081 step time: 0.3615
2/3, train_loss: 0.9919 step time: 0.3662
3/3, train_loss: 1.0054 step time: 0.3674
epoch 9 average loss: 1.0018
time consuming of epoch 9 is: 1.0951
----------
epoch 10/10
1/3, train_loss: 0.9888 step time: 0.3584
2/3, train_loss: 1.0097 step time: 0.3593
3/3, train_loss: 1.0053 step time: 0.3574
epoch 10 average loss: 1.0012
time consuming of epoch 10 is: 1.0751
train completed, best_metric: -1.0000 at epoch: -1 total time: 12.0839
